{"version":3,"sources":["webpack://squarefall/./src/constants.js","webpack://squarefall/./src/point/point.js","webpack://squarefall/./src/square/square.js","webpack://squarefall/./src/shape/shape.js","webpack://squarefall/./src/shape-generator/shape-generator.js","webpack://squarefall/./src/grid/grid.js","webpack://squarefall/./src/score/score.js","webpack://squarefall/./src/speed/speed.js","webpack://squarefall/./src/game/game.js","webpack://squarefall/./src/bootstrap.js"],"names":["SQUARE_SIDE_LENGTH","Point","x","y","this","oldX","oldY","translate","rotateClockwise","rotateCounterClockwise","offsetX","offsetY","otherPoint","Square","point","fillStyle","context","sideLength","beginPath","fillRect","strokeStyle","arc","Math","PI","stroke","fillText","drawEdgePoint","color","clearRect","otherSquare","undefined","equals","clear","moveDown","draw","moveLeft","moveRight","transformClockwise","transformCounterClockwise","yLimit","Shape","pointOfTranslation","points","pointOfTranslationSquare","otherSquares","map","squares","largestY","calculateLargestY","smallestX","calculateSmallestX","largestX","calculateLargestX","getPointOfTranslationX","squareToRemove","Object","prototype","hasOwnProperty","call","filter","square","forEach","drawPoint","drawCoordinates","drawEdgePoints","thisPoint","length","otherShape","sort","pop","shift","redraw","isBelowLimit","clearAndMoveDown","I","xCoordOfAppearance","super","otherPoints","init","O","point1","point2","point3","L","J","S","Z","T","ShapeGenerator","canvas","shapeTypesAsArray","values","ChosenShapeType","round","random","width","Grid","shapes","movingShape","thereIsRoomToMoveDown","thereIsRoomToMoveLeft","thereIsRoomToMoveRight","moveShapeDown","shape","some","allPointsFitInsideGrid","noOtherShapeIsInTheWay","every","height","getLargestY","noOtherShapeIsInTheWayDown","getSmallestX","noOtherShapeIsInTheWayLeft","getLargestX","noOtherShapeIsInTheWayRight","amountOfPointsInRow","rowCount","fullRowCount","i","occupiedSquaresAndShapes","Map","set","size","remove","shiftDownward","rowIndex","clearAndMoveSquaresBelowYLimit","hasCommonPointWith","moveTo","lineTo","drawPoints","Score","high","getHighScore","document","getElementById","innerText","current","highScore","localStorage","getItem","rowsCleared","value","newValue","setItem","Speed","delay","desiredSpeed","increase","Game","getContext","setCanvasWidth","setCanvasHeight","window","setTimeout","hidden","style","display","grid","shapeGenerator","generatedShape","generateShape","push","score","speed","SCORE_PER_SPEED_INCREASE","MAX_SPEED","paused","event","key","pause","keyPressed","moveShapeLeft","rotateShape","moveShapeRight","clearInterval","heartbeatInterval","moveShapeToBottom","removeFullRows","requestScoreIncrease","requestSpeedIncrease","end","setInterval","self","heartbeat","drawAllPoints","drawLines","keyHandler","bind","addEventListener","pauseKeyHandler","isPaused","screen","availWidth","desiredHeight","availHeight","submit","showGameOverText","removeEventListener","currentSpeed","trunc","get","increaseIfNecessary","increment","createElement","setAttribute","append"],"mappings":"mBAAO,MAAMA,EAAqB,GCInB,MAAMC,EACnB,YAAaC,EAAGC,GACdC,KAAKF,EAAIA,EACTE,KAAKD,EAAIA,EAGX,WACEC,KAAKD,GAAKH,EAGZ,WACEI,KAAKF,IAAK,GAGZ,YACEE,KAAKF,GAAKF,EAGZ,mBAAoBK,EAAMC,GACxBF,KAAKG,WAAWF,GAAOC,GACvBF,KAAKI,kBACLJ,KAAKG,UAAUF,EAAMC,GAGvB,0BAA2BD,EAAMC,GAC/BF,KAAKG,WAAWF,GAAOC,GACvBF,KAAKK,yBACLL,KAAKG,UAAUF,EAAMC,GAGvB,UAAWI,EAASC,GAClBP,KAAKF,EAAIE,KAAKF,EAAIQ,EAClBN,KAAKD,EAAIC,KAAKD,EAAIQ,EAGpB,kBACE,MAAMN,EAAOD,KAAKF,EACZI,EAAOF,KAAKD,EAclBC,KAAKF,GAAKI,EACVF,KAAKD,EAAIE,EAGX,yBACE,MAAMA,EAAOD,KAAKF,EACZI,EAAOF,KAAKD,EAclBC,KAAKF,EAAII,EACTF,KAAKD,GAAKE,EAGZ,OAAQO,GACN,OAAOA,aAAsBX,GACH,iBAAjBW,EAAWV,GACM,iBAAjBU,EAAWT,GAClBC,KAAKF,IAAMU,EAAWV,GACtBE,KAAKD,IAAMS,EAAWT,GClFb,MAAMU,EACnB,YAAaC,EAAOC,EAAWC,GAE7BZ,KAAKU,MAAQA,EACbV,KAAKW,UAAYA,EACjBX,KAAKY,QAAUA,EACfZ,KAAKa,WAAajB,EAGpB,OACEI,KAAKY,QAAQE,YACbd,KAAKY,QAAQD,UAAYX,KAAKW,UAC9BX,KAAKY,QAAQG,SAASf,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,EAAGC,KAAKa,WAAYb,KAAKa,YAG1E,YACEb,KAAKY,QAAQE,YACbd,KAAKY,QAAQI,YAAc,MAC3BhB,KAAKY,QAAQK,IAAIjB,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,EAAG,GAAI,EAAG,EAAImB,KAAKC,IAC7DnB,KAAKY,QAAQQ,SAGf,kBACEpB,KAAKY,QAAQD,UAAY,QACzBX,KAAKY,QAAQS,SAAS,GAAGrB,KAAKU,MAAMZ,OAAOE,KAAKU,MAAMX,IAAKC,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,GAGtF,iBACEC,KAAKsB,cAAc,SAAUtB,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,GACtDC,KAAKsB,cAAc,OAAQtB,KAAKU,MAAMZ,EAAIF,EAAoBI,KAAKU,MAAMX,GACzEC,KAAKsB,cAAc,UAAWtB,KAAKU,MAAMZ,EAAIF,EAAoBI,KAAKU,MAAMX,EAAIH,GAChFI,KAAKsB,cAAc,QAAStB,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,EAAIH,GAG3D,cAAe2B,EAAOzB,EAAGC,GACvBC,KAAKY,QAAQE,YACbd,KAAKY,QAAQI,YAAcO,EAC3BvB,KAAKY,QAAQK,IAAInB,EAAGC,EAAG,GAAI,EAAG,EAAImB,KAAKC,IACvCnB,KAAKY,QAAQQ,SAGf,QACEpB,KAAKY,QAAQY,UAAUxB,KAAKU,MAAMZ,EAAGE,KAAKU,MAAMX,EAAGC,KAAKa,WAAYb,KAAKa,YAG3E,OAAQY,GACN,YAAuBC,IAAhBD,GACLA,aAAuBhB,GACvBT,KAAKa,aAAeY,EAAYZ,YAChCb,KAAKU,MAAMiB,OAAOF,EAAYf,OAGlC,WACEV,KAAK4B,QACL5B,KAAKU,MAAMmB,WACX7B,KAAK8B,OAGP,mBACE9B,KAAK4B,QACL5B,KAAKU,MAAMmB,WAGb,WACE7B,KAAK4B,QACL5B,KAAKU,MAAMqB,WACX/B,KAAK8B,OAGP,YACE9B,KAAK4B,QACL5B,KAAKU,MAAMsB,YACXhC,KAAK8B,OAGP,mBAAoBhC,EAAGC,GACrBC,KAAKU,MAAMuB,mBAAmBnC,EAAGC,GAGnC,0BAA2BD,EAAGC,GAC5BC,KAAKU,MAAMwB,0BAA0BpC,EAAGC,GAG1C,aAAcoC,GACZ,OAAOnC,KAAKU,MAAMX,EAAIoC,GCjFnB,MAAMC,EACX,KAAMzB,EAAW0B,EAAoBC,EAAQ1B,GAC3CZ,KAAKqC,mBAAqBA,EAE1B,MAAME,EAA2B,IAAI9B,EAAO4B,EAAoB1B,EAAWC,GACrE4B,EAAeF,EAAOG,KAAI/B,GAAS,IAAID,EAAOC,EAAOC,EAAWC,KAEtEZ,KAAK0C,QAAU,CAACH,KAA6BC,GAE7CxC,KAAK2C,SAAW3C,KAAK4C,oBACrB5C,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,oBAErBhD,KAAKY,QAAUA,EAGjB,yBACE,OAAOZ,KAAKiD,uBAGd,OAAQC,GACFC,OAAOC,UAAUC,eAAeC,KAAKJ,EAAgB,UACvDC,OAAOC,UAAUC,eAAeC,KAAKJ,EAAexC,MAAO,MAC3DyC,OAAOC,UAAUC,eAAeC,KAAKJ,EAAexC,MAAO,OAC3DV,KAAK0C,QAAU1C,KAAK0C,QAAQa,QAAOC,IAAYA,EAAO7B,OAAOuB,KAC7DlD,KAAK2C,SAAW3C,KAAK4C,oBACrB5C,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,qBAIzB,OACEhD,KAAK0C,QAAQe,SAAQD,GAAUA,EAAO1B,SAGxC,aACE9B,KAAK0C,QAAQe,SAAQD,GAAUA,EAAOE,cAGxC,kBACE1D,KAAK0C,QAAQe,SAASD,GAAWA,EAAOG,oBAG1C,yBACE3D,KAAKY,QAAQD,UAAY,2BAEzBX,KAAKY,QAAQE,YACbd,KAAKY,QAAQK,IAAIjB,KAAKqC,mBAAmBvC,EAAGE,KAAKqC,mBAAmBtC,EAAG,GAAI,EAAG,EAAImB,KAAKC,IACvFnB,KAAKY,QAAQQ,SAGf,iBACEpB,KAAK0C,QAAQe,SAAQD,IACnBA,EAAOI,oBAIX,QACE5D,KAAK0C,QAAQe,SAAQD,GAAUA,EAAO5B,UAGxC,kBACE5B,KAAK0C,QAAQe,SAAQD,IACnBA,EAAOvB,mBAAmBjC,KAAKqC,mBAAmBvC,EAAGE,KAAKqC,mBAAmBtC,MAE/EC,KAAK2C,SAAW3C,KAAK4C,oBACrB5C,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,oBAGvB,yBACEhD,KAAK0C,QAAQe,SAAQD,IACnBA,EAAOtB,0BAA0BlC,KAAKqC,mBAAmBvC,EAAGE,KAAKqC,mBAAmBtC,MAEtFC,KAAK2C,SAAW3C,KAAK4C,oBACrB5C,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,oBAGvB,SAAUxC,GACR,MACMqD,EADS7D,KAAK0C,QAAQD,KAAIe,GAAU,IAAI3D,EAAM2D,EAAO9C,MAAMZ,EAAG0D,EAAO9C,MAAMX,KACxDwD,QAAO7C,GAASA,EAAMiB,OAAOnB,KACtD,YAAqBkB,IAAdmC,GAA2BA,EAAUC,QAA+B,IAArBD,EAAUC,QAAgBD,EAAUlC,OAAOnB,GAGnG,mBAAoBuD,GAClB,IAAK,MAAMP,KAAUxD,KAAK0C,QACxB,IAAK,MAAMjB,KAAesC,EAAWrB,QACnC,GAAIc,EAAO7B,OAAOF,GAChB,OAAO,EAKb,OAAO,EAGT,WACEzB,KAAK4B,QACL5B,KAAK0C,QAAQe,SAAQD,GAAUA,EAAO3B,aACtC7B,KAAK2C,SAAW3C,KAAK4C,oBACrB5C,KAAK8B,OAGP,WACE9B,KAAK4B,QACL5B,KAAK0C,QAAQe,SAAQD,GAAUA,EAAOzB,aACtC/B,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,oBACrBhD,KAAK8B,OAGP,YACE9B,KAAK4B,QACL5B,KAAK0C,QAAQe,SAAQD,GAAUA,EAAOxB,cACtChC,KAAK6C,UAAY7C,KAAK8C,qBACtB9C,KAAK+C,SAAW/C,KAAKgD,oBACrBhD,KAAK8B,OAGP,oBACE,OAAO9B,KAAK0C,QACTD,KAAIe,GAAUA,EAAO9C,MAAMX,IAC3BiE,OACAC,MAGL,qBACE,OAAOjE,KAAK0C,QACTD,KAAIe,GAAUA,EAAO9C,MAAMZ,IAC3BkE,OACAE,QAGL,oBACE,OAAOlE,KAAK0C,QACTD,KAAIe,GAAUA,EAAO9C,MAAMZ,IAC3BkE,OACAC,MAGL,cACE,OAAOjE,KAAK2C,SAGd,eACE,OAAO3C,KAAK6C,UAGd,cACE,OAAO7C,KAAK+C,SAGd,+BAAgCZ,GAC9B,IAAIgC,GAAS,EAOb,OANAnE,KAAK0C,QAAQe,SAAQD,IACfA,EAAOY,aAAajC,KACtBqB,EAAOa,mBACPF,GAAS,MAGNA,GAiIX,MAUA,EAVmB,CACjBG,EAtFF,cAAgBlC,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMnC,EAAqB,IAAIxC,EAAM0E,EAAoB,GAKnDE,EAAc,CAJL,IAAI5E,EAAM0E,EAAqB,IAAwB,GACvD,IAAI1E,EAAM0E,EAAqB3E,EAAoB,GACnD,IAAIC,EAAM0E,EAAqB3E,EAAoB,IAMlE4E,MAAME,KAFY,cAEIrC,EAAoBoC,EAAa7D,KA0EzD+D,EA/HF,cAAgBvC,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB3E,EAAoB,GAC5DiF,EAAS,IAAIhF,EAAM0E,EAAoB,GACvCO,EAAS,IAAIjF,EAAM0E,EAAqB3E,EAAoBA,GAC5DyC,EAAqB,IAAIxC,EAAM0E,EAAoB3E,GAEnD6E,EAAc,CAACG,EAAQC,EAAQC,GAIrCN,MAAME,KAFY,UAEIrC,EAAoBoC,EAAa7D,GAIzD,mBAGA,4BA4GAmE,EArCF,cAAgB3C,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB,IAAwB,GAChElC,EAAqB,IAAIxC,EAAM0E,EAAqB3E,EAAoB,GAIxE6E,EAAc,CAACG,EAHN,IAAI/E,EAAM0E,EAAoB,GAC9B,IAAI1E,EAAM0E,EAAqB,IAAwB3E,IAMtE4E,MAAME,KAFY,YAEIrC,EAAoBoC,EAAa7D,KAyBzDoE,EArBF,cAAgB5C,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB3E,EAAoB,GAC5DyC,EAAqB,IAAIxC,EAAM0E,EAAoB,GAInDE,EAAc,CAACG,EAHN,IAAI/E,EAAM0E,EAAqB3E,EAAoB,GACnD,IAAIC,EAAM0E,EAAqB3E,EAAoBA,IAMlE4E,MAAME,KAFY,aAEIrC,EAAoBoC,EAAa7D,KASzDqE,EAzEF,cAAgB7C,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB3E,EAAoB,GAC5DiF,EAAS,IAAIhF,EAAM0E,EAAoB,GACvCO,EAAS,IAAIjF,EAAM0E,EAAqB,IAAwB3E,GAChEyC,EAAqB,IAAIxC,EAAM0E,EAAqB3E,EAAoBA,GAExE6E,EAAc,CAACG,EAAQC,EAAQC,GAIrCN,MAAME,KAFY,QAEIrC,EAAoBoC,EAAa7D,KA6DzDsE,EAzDF,cAAgB9C,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB3E,EAAoB,GAC5DiF,EAAS,IAAIhF,EAAM0E,EAAoB,GACvClC,EAAqB,IAAIxC,EAAM0E,EAAoB3E,GAGnD6E,EAAc,CAACG,EAAQC,EAFd,IAAIhF,EAAM0E,EAAqB3E,EAAoBA,IAMlE4E,MAAME,KAFY,MAEIrC,EAAoBoC,EAAa7D,KA6CzDuE,EA7GF,cAAgB/C,EACd,YAAamC,EAAoB3D,GAC/B4D,QAEA,MAAMI,EAAS,IAAI/E,EAAM0E,EAAqB3E,EAAoBA,GAC5DyC,EAAqB,IAAIxC,EAAM0E,EAAoB3E,GAInD6E,EAAc,CAACG,EAHN,IAAI/E,EAAM0E,EAAqB3E,EAAoBA,GACnD,IAAIC,EAAM0E,EAAoB,IAM7CC,MAAME,KAFY,YAEIrC,EAAoBoC,EAAa7D,MC5MpD,MAAMwE,EACX,YAAaC,EAAQzE,GACnBZ,KAAKqF,OAASA,EACdrF,KAAKY,QAAUA,EAGjB,gBACE,MAAM0E,EAAoBnC,OAAOoC,OAAO,GAKxC,OADc,IAAIC,EAFMF,EADCpE,KAAKuE,MAAMvE,KAAKwE,UAAYJ,EAAkBxB,OAAS,MAEhD9D,KAAKqF,OAAOM,MAAQ,EACO3F,KAAKY,UCTrD,MAAMgF,EACnB,YAAaP,EAAQzE,GACnBZ,KAAKqF,OAASA,EACdrF,KAAKY,QAAUA,EACfZ,KAAK6F,OAAS,GACd7F,KAAK8F,iBAAcpE,EAGrB,gBACM1B,KAAK+F,yBACP/F,KAAK8F,YAAYjE,WAIrB,gBACM7B,KAAKgG,yBACPhG,KAAK8F,YAAY/D,WAIrB,iBACM/B,KAAKiG,0BACPjG,KAAK8F,YAAY9D,YAIrB,oBACE,KAAOhC,KAAK+F,yBACV/F,KAAKkG,gBAIT,6BACE,MAAM5D,EAAStC,KAAK8F,YAAYpD,QAAQD,KAAIe,GAAUA,EAAO9C,QAE7D,IAAK,MAAMyF,KAASnG,KAAK6F,OACvB,GAAIM,IAAUnG,KAAK8F,YAAa,CAC9B,MAAMrB,EAAc0B,EAAMzD,QAAQD,KAAIe,GAAUA,EAAO9C,QASvD,GAPqB4B,EAClBiB,QAAO7C,GAAS+D,EACd2B,MAAK5F,GACJA,EAAWV,IAAMY,EAAMZ,GACvBU,EAAWT,IAAMW,EAAMX,EAAIH,MAGhBkE,OAAS,EACxB,OAAO,EAKb,OAAO,EAGT,6BACE,MAAMxB,EAAStC,KAAK8F,YAAYpD,QAAQD,KAAIe,GAAUA,EAAO9C,QAE7D,IAAK,MAAMyF,KAASnG,KAAK6F,OACvB,GAAIM,IAAUnG,KAAK8F,YAAa,CAC9B,MAAMrB,EAAc0B,EAAMzD,QAAQD,KAAIe,GAAUA,EAAO9C,QASvD,GAPqB4B,EAClBiB,QAAO7C,GAAS+D,EACd2B,MAAK5F,GACJA,EAAWV,EAAIF,IAAuBc,EAAMZ,GAC5CU,EAAWT,IAAMW,EAAMX,MAGZ+D,OAAS,EACxB,OAAO,EAKb,OAAO,EAGT,8BACE,MAAMxB,EAAStC,KAAK8F,YAAYpD,QAAQD,KAAIe,GAAUA,EAAO9C,QAE7D,IAAK,MAAMyF,KAASnG,KAAK6F,OACvB,GAAIM,IAAUnG,KAAK8F,YAAa,CAC9B,MAAMrB,EAAc0B,EAAMzD,QAAQD,KAAIe,GAAUA,EAAO9C,QASvD,GAPqB4B,EAClBiB,QAAO7C,GAAS+D,EACd2B,MAAK5F,GACJA,EAAWV,IAAMY,EAAMZ,EAAIF,GAC3BY,EAAWT,IAAMW,EAAMX,MAGZ+D,OAAS,EACxB,OAAO,EAKb,OAAO,EAGT,cACE9D,KAAK8F,YAAYlE,QACjB5B,KAAK8F,YAAY1F,kBAEXJ,KAAKqG,0BAA4BrG,KAAKsG,uBAAuBtG,KAAK8F,cACtE9F,KAAK8F,YAAYzF,yBAGnBL,KAAK8F,YAAYhE,OAGnB,yBACE,OAAO9B,KAAK8F,YAAYpD,QAAQD,KAAIe,GAAUA,EAAO9C,MAAMZ,IACxDyG,OAAMzG,GAAKA,GAAK,GAAKA,GAAKE,KAAKqF,OAAOM,MAAQ/F,KAC/CI,KAAK8F,YAAYpD,QAAQD,KAAIe,GAAUA,EAAO9C,MAAMX,IACjDwG,OAAMxG,GAAKA,GAAK,GAAKA,GAAKC,KAAKqF,OAAOmB,OAAS5G,IAGtD,wBAEE,OADiBI,KAAK8F,YAAYW,cACf7G,EAAqBI,KAAKqF,OAAOmB,QAAWxG,KAAK0G,6BAGtE,wBACE,OAAO1G,KAAK8F,YAAYa,eAAiB/G,GAAsB,GAAKI,KAAK4G,6BAG3E,yBACE,OAAO5G,KAAK8F,YAAYe,cAAgBjH,EAAqBI,KAAKqF,OAAOM,OAAS3F,KAAK8G,8BAGzF,iBACE,MAAMC,EAAsB/G,KAAKqF,OAAOM,MAAQ/F,EAC1CoH,EAAWhH,KAAKqF,OAAOmB,OAAS5G,EACtC,IAAIqH,EAAe,EAEnB,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAUE,GAAK,EAAG,CACpC,MAAMC,EAA2B,IAAIC,IACrC,IAAK,MAAMjB,KAASnG,KAAK6F,OACvB,IAAK,MAAMrC,KAAU2C,EAAMzD,QACrBc,EAAO9C,MAAMX,IAAMmH,EAAItH,GACzBuH,EAAyBE,IAAI7D,EAAQ2C,GAK3C,GAAIgB,EAAyBG,OAASP,EAAqB,CACzDE,GAAgB,EAChB,IAAK,MAAOzD,EAAQ2C,KAAUgB,EAC5B3D,EAAO5B,QACPuE,EAAMoB,OAAO/D,GAEfxD,KAAKwH,cAAcN,IAGvB,OAAOD,EAGT,cAAeQ,GAEb,MAAMtF,EAASsF,EAAW7H,EAC1B,IAAK,MAAMuG,KAASnG,KAAK6F,OACRM,EAAMuB,+BAA+BvF,IAElDgE,EAAMrE,OAKZ,uBAAwBqE,GACtB,IAAK,MAAMpC,KAAc/D,KAAK6F,OAC5B,GAAI9B,IAAeoC,GACbpC,EAAW4D,mBAAmBxB,GAChC,OAAO,EAKb,OAAO,EAGT,YACE,MAAMa,EAAWhH,KAAKqF,OAAOmB,OAAS5G,EACtC,IAAK,IAAIsH,EAAI,EAAGA,EAAIF,EAAUE,GAAK,EACjClH,KAAKY,QAAQI,YAAc,QAC3BhB,KAAKY,QAAQE,YACbd,KAAKY,QAAQgH,OAAO,EAAGV,EAAItH,GAC3BI,KAAKY,QAAQiH,OAAO7H,KAAKqF,OAAOM,MAAOuB,EAAItH,GAC3CI,KAAKY,QAAQQ,SAIjB,gBACE,IAAK,MAAM+E,KAASnG,KAAK6F,OACvBM,EAAM2B,aAIV,kBACE,IAAK,MAAM3B,KAASnG,KAAK6F,OACvBM,EAAMxC,mBC7MG,MAAMoE,EACnB,cACE/H,KAAKgI,KAAOD,EAAME,eAClBC,SAASC,eAAe,cAAcC,UAAYpI,KAAKgI,KACvDhI,KAAKqI,QAAU,EAGjB,sBACE,IAAIC,EAAYC,aAAaC,QAAQ,eAIrC,YAHkB9G,IAAd4G,IACFA,EAAY,GAEPA,EAGT,yBAA0BG,GAExB,OADe,GAAKA,EAAe,EAIrC,UAAWC,GACT1I,KAAKqI,SAAWK,EAChBR,SAASC,eAAe,iBAAiBC,UAAYpI,KAAKqI,QAG5D,MACE,OAAOrI,KAAKqI,QAGd,IAAKM,GACH3I,KAAKqI,QAAUM,EAGjB,SACM3I,KAAKqI,QAAUrI,KAAKgI,OACtBO,aAAaK,QAAQ,cAAe5I,KAAKqI,SACzCH,SAASC,eAAe,cAAcC,UAAYpI,KAAKqI,UCpC9C,MAAMQ,EACnB,cACE7I,KAAK0I,MAAQ,EACb1I,KAAK8I,MAAQ,IAGf,WACE9I,KAAK0I,OAAS,EACd1I,KAAK8I,MAAQ,IAAO,IAAM9I,KAAK0I,MAGjC,oBAAqBK,GAInB,OAHIA,EAAe/I,KAAK0I,OACtB1I,KAAKgJ,WAEAhJ,KAAK0I,OCRT,MAAMO,EACX,YAAa5D,GACXrF,KAAKqF,OAASA,EACdrF,KAAKY,QAAUZ,KAAKqF,OAAO6D,WAAW,MAGxC,OACElJ,KAAKmJ,iBACLnJ,KAAKoJ,kBAELC,OAAOC,YAAW,KAChBpB,SAASC,eAAe,WAAWoB,QAAS,EAC5CrB,SAASC,eAAe,aAAaqB,MAAMC,QAAU,SACpD,KAEHzJ,KAAK0J,KAAO,IAAI9D,EAAK5F,KAAKqF,OAAQrF,KAAKY,SACvCZ,KAAK2J,eAAiB,IAAIvE,EAAepF,KAAKqF,OAAQrF,KAAKY,SAC3D,MAAMgJ,EAAiB5J,KAAK2J,eAAeE,gBAC3C7J,KAAK0J,KAAK7D,OAAOiE,KAAKF,GACtB5J,KAAK0J,KAAK5D,YAAc8D,EACxBA,EAAe9H,OACf9B,KAAK+J,MAAQ,IAAIhC,EACjB/H,KAAKgK,MAAQ,IAAInB,EACjBX,SAASC,eAAe,iBAAiBC,UAAYpI,KAAKgK,MAAMtB,MAChE1I,KAAKiK,yBAA2B,GAChCjK,KAAKkK,UAAY,EACjBlK,KAAKmK,OAAUC,IACb,GAAIpK,KAAK0J,KAAK5D,YACZ,OAAQsE,EAAMC,KACZ,IAAK,IAAKrK,KAAKsK,UAKrBtK,KAAKuK,WAAcH,IACjB,GAAIpK,KAAK0J,KAAK5D,YACZ,OAAQsE,EAAMC,KACZ,IAAK,IAAKrK,KAAK0J,KAAKc,gBAAiB,MACrC,IAAK,IAAKxK,KAAK0J,KAAKe,cAAe,MACnC,IAAK,IAAKzK,KAAK0J,KAAKgB,iBAAkB,MACtC,IAAK,IAMH,GAJArB,OAAOsB,cAAc3K,KAAK4K,mBAC1B5K,KAAK4K,uBAAoBlJ,EACzB1B,KAAK0J,KAAKmB,qBAEL7K,KAAK0J,KAAK3D,wBAAyB,CACtC/F,KAAK0J,KAAK5D,iBAAcpE,EACxB,MAAMuF,EAAejH,KAAK0J,KAAKoB,iBAC3B7D,EAAe,IACjBjH,KAAK+K,qBAAqB9D,GAC1BjH,KAAKgL,wBAEP,MAAMpB,EAAiB5J,KAAK2J,eAAeE,gBACvC7J,KAAK0J,KAAKpD,uBAAuBsD,IACnC5J,KAAK0J,KAAK7D,OAAOiE,KAAKF,GACtBA,EAAe9H,OACf9B,KAAK0J,KAAK5D,YAAc8D,GAExB5J,KAAKiL,MAILjL,KAAK0J,KAAK5D,kBAA0CpE,IAA3B1B,KAAK4K,oBAChC5K,KAAK4K,kBAAoBvB,OAAO6B,aAAY,IAAMC,EAAKC,aAAaD,EAAKnB,MAAMlB,QAEjF,MACF,IAAK,IAAK9I,KAAK0J,KAAK2B,gBAAiB,MACrC,IAAK,IAAKrL,KAAK0J,KAAK/F,kBAAmB,MACvC,IAAK,IAAK3D,KAAK0J,KAAK5D,YAAYlC,iBAAkB,MAClD,IAAK,IAAK5D,KAAK0J,KAAK4B,cAK1BtL,KAAKuL,WAAavL,KAAKuK,WAAWiB,KAAKxL,MACvCqJ,OAAOoC,iBAAiB,WAAYzL,KAAKuL,YACzCvL,KAAK0L,gBAAkB1L,KAAKmK,OAAOqB,KAAKxL,MACxCqJ,OAAOoC,iBAAiB,WAAYzL,KAAK0L,iBAEzC,MAAMP,EAAOnL,KACbA,KAAK4K,kBAAoBvB,OAAO6B,aAAY,IAAMC,EAAKC,aAAaD,EAAKnB,MAAMlB,OAE/E9I,KAAK2L,UAAW,EAGlB,iBACuB,IAEFtC,OAAOuC,OAAOC,aAC/B7L,KAAKqF,OAAOM,MAHO,KAOvB,kBACE,IAAImG,EAAgBzC,OAAOuC,OAAOG,YAE9BD,EAAgB,KAAQ,IAC1BA,GAAiBA,EAAgB,KAGnCA,GAAiB,IAEbA,EAAgB,MAClBA,EAAgB,KAGlB9L,KAAKqF,OAAOmB,OAASsF,EAGvB,YACE,IAAK9L,KAAK0J,KAAK3D,wBAAyB,CACtC/F,KAAK0J,KAAK5D,iBAAcpE,EACxB,MAAMuF,EAAejH,KAAK0J,KAAKoB,iBAC3B7D,EAAe,IACjBjH,KAAK+K,qBAAqB9D,GAC1BjH,KAAKgL,wBAEP,MAAMpB,EAAiB5J,KAAK2J,eAAeE,gBACvC7J,KAAK0J,KAAKpD,uBAAuBsD,IACnC5J,KAAK0J,KAAK7D,OAAOiE,KAAKF,GACtBA,EAAe9H,OACf9B,KAAK0J,KAAK5D,YAAc8D,GAExB5J,KAAKiL,MAILjL,KAAK0J,KAAK5D,aAAe9F,KAAK0J,KAAK3D,yBACrC/F,KAAK0J,KAAKxD,gBAId,MACElG,KAAK+J,MAAMiC,SACX/C,EAAKgD,mBACL5C,OAAOsB,cAAc3K,KAAK4K,mBAC1BvB,OAAO6C,oBAAoB,WAAYlM,KAAKuL,YAC5ClC,OAAO6C,oBAAoB,WAAYlM,KAAK0L,iBAG9C,uBACE,GAAI1L,KAAKgK,MAAMtB,MAAQ1I,KAAKkK,UAAW,CACrC,MAAMiC,EAAenM,KAAKgK,MAAMtB,MAC1BK,EAAe7H,KAAKkL,MAAMpM,KAAK+J,MAAMsC,MAAQrM,KAAKiK,0BAGxD,GAFiBjK,KAAKgK,MAAMsC,oBAAoBvD,GAEjCoD,EAAc,CAC3B9C,OAAOsB,cAAc3K,KAAK4K,mBAC1B,MAAMO,EAAOnL,KACbA,KAAK4K,kBAAoBvB,OAAO6B,aAAY,IAAMC,EAAKC,aAAaD,EAAKnB,MAAMlB,OAC/EZ,SAASC,eAAe,iBAAiBC,UAAYpI,KAAKgK,MAAMtB,QAKtE,qBAAsBD,GACpBzI,KAAK+J,MAAMwC,UAAU9D,GAGvB,QACE,GAAIzI,KAAK2L,SAAU,CACjBtC,OAAOoC,iBAAiB,WAAYzL,KAAKuL,YACzC,MAAMJ,EAAOnL,KACbA,KAAK4K,kBAAoBvB,OAAO6B,aAAY,IAAMC,EAAKC,aAAapL,KAAKgK,MAAMlB,YAE/EO,OAAOsB,cAAc3K,KAAK4K,mBAC1BvB,OAAO6C,oBAAoB,WAAYlM,KAAKuL,YAE9CvL,KAAK2L,UAAY3L,KAAK2L,SAGxB,0BACEzD,SAASC,eAAe,qBAAqBoB,QAAS,GClL1D,MAAMlE,EAAS6C,SAASsE,cAAc,UACtCnH,EAAOoH,aAAa,KAAM,cAEJvE,SAASC,eAAe,iBAChCuE,OAAOrH,GAER,IAAI4D,EAAK5D,GACjBX,Q","file":"main.js","sourcesContent":["export const SQUARE_SIDE_LENGTH = 50\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport default class Point {\n  constructor (x, y) {\n    this.x = x\n    this.y = y\n  }\n\n  moveDown () {\n    this.y += SQUARE_SIDE_LENGTH\n  }\n\n  moveLeft () {\n    this.x += -SQUARE_SIDE_LENGTH\n  }\n\n  moveRight () {\n    this.x += SQUARE_SIDE_LENGTH\n  }\n\n  transformClockwise (oldX, oldY) {\n    this.translate(-oldX, -oldY)\n    this.rotateClockwise()\n    this.translate(oldX, oldY)\n  }\n\n  transformCounterClockwise (oldX, oldY) {\n    this.translate(-oldX, -oldY)\n    this.rotateCounterClockwise()\n    this.translate(oldX, oldY)\n  }\n\n  translate (offsetX, offsetY) {\n    this.x = this.x + offsetX\n    this.y = this.y + offsetY\n  }\n\n  rotateClockwise () {\n    const oldX = this.x\n    const oldY = this.y\n\n    /*\n    We are performing a clockwise 90 degree rotation in a 2D coordinate system.\n    https://en.wikipedia.org/wiki/Rotation_matrix\n\n    90 degrees = Math.PI / 2 radians\n    Math.sin(Math.PI / 2) = 1\n    Math.cos(Math.PI / 2) = 0\n\n    newX = oldX * 0 - oldY * 1 = -oldY\n    newY = oldX * 1 + oldY * 0 = oldX\n    */\n\n    this.x = -oldY\n    this.y = oldX\n  }\n\n  rotateCounterClockwise () {\n    const oldX = this.x\n    const oldY = this.y\n\n    /*\n    We are performing a counter-clockwise 90 degree rotation in a 2D coordinate system.\n    https://en.wikipedia.org/wiki/Rotation_matrix\n\n    -90 degrees = 3 * Math.PI / 2 radians\n    Math.sin(3 * Math.PI / 2) = -1\n    Math.cos(3 * Math.PI / 2) = 0\n\n    newX = oldX * 0 - oldY * -1 = oldY\n    newY = oldX * -1 + oldY * 0 = -oldX\n    */\n\n    this.x = oldY\n    this.y = -oldX\n  }\n\n  equals (otherPoint) {\n    return otherPoint instanceof Point &&\n      typeof otherPoint.x === 'number' &&\n      typeof otherPoint.y === 'number' &&\n      this.x === otherPoint.x &&\n      this.y === otherPoint.y\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nexport default class Square {\n  constructor (point, fillStyle, context) {\n    // The point of a Square always refers to its top left point\n    this.point = point\n    this.fillStyle = fillStyle\n    this.context = context\n    this.sideLength = SQUARE_SIDE_LENGTH\n  }\n\n  draw () {\n    this.context.beginPath()\n    this.context.fillStyle = this.fillStyle\n    this.context.fillRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  drawPoint () {\n    this.context.beginPath()\n    this.context.strokeStyle = 'red'\n    this.context.arc(this.point.x, this.point.y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  drawCoordinates () {\n    this.context.fillStyle = 'black'\n    this.context.fillText(`${this.point.x} | ${this.point.y}`, this.point.x, this.point.y)\n  }\n\n  drawEdgePoints () {\n    this.drawEdgePoint('yellow', this.point.x, this.point.y)\n    this.drawEdgePoint('blue', this.point.x + SQUARE_SIDE_LENGTH, this.point.y)\n    this.drawEdgePoint('magenta', this.point.x + SQUARE_SIDE_LENGTH, this.point.y + SQUARE_SIDE_LENGTH)\n    this.drawEdgePoint('black', this.point.x, this.point.y + SQUARE_SIDE_LENGTH)\n  }\n\n  drawEdgePoint (color, x, y) {\n    this.context.beginPath()\n    this.context.strokeStyle = color\n    this.context.arc(x, y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  clear () {\n    this.context.clearRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  equals (otherSquare) {\n    return otherSquare !== undefined &&\n      otherSquare instanceof Square &&\n      this.sideLength === otherSquare.sideLength &&\n      this.point.equals(otherSquare.point)\n  }\n\n  moveDown () {\n    this.clear()\n    this.point.moveDown()\n    this.draw()\n  }\n\n  clearAndMoveDown () {\n    this.clear()\n    this.point.moveDown()\n  }\n\n  moveLeft () {\n    this.clear()\n    this.point.moveLeft()\n    this.draw()\n  }\n\n  moveRight () {\n    this.clear()\n    this.point.moveRight()\n    this.draw()\n  }\n\n  transformClockwise (x, y) {\n    this.point.transformClockwise(x, y)\n  }\n\n  transformCounterClockwise (x, y) {\n    this.point.transformCounterClockwise(x, y)\n  }\n\n  isBelowLimit (yLimit) {\n    return this.point.y < yLimit\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nimport Point from '../point/point.js'\nimport Square from '../square/square.js'\n\nexport class Shape {\n  init (fillStyle, pointOfTranslation, points, context) {\n    this.pointOfTranslation = pointOfTranslation\n\n    const pointOfTranslationSquare = new Square(pointOfTranslation, fillStyle, context)\n    const otherSquares = points.map(point => new Square(point, fillStyle, context))\n\n    this.squares = [pointOfTranslationSquare, ...otherSquares]\n\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n\n    this.context = context\n  }\n\n  getPointOfTranslationX () {\n    return this.getPointOfTranslationX\n  }\n\n  remove (squareToRemove) {\n    if (Object.prototype.hasOwnProperty.call(squareToRemove, 'point') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'x') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'y')) {\n      this.squares = this.squares.filter(square => !(square.equals(squareToRemove)))\n      this.largestY = this.calculateLargestY()\n      this.smallestX = this.calculateSmallestX()\n      this.largestX = this.calculateLargestX()\n    }\n  }\n\n  draw () {\n    this.squares.forEach(square => square.draw())\n  }\n\n  drawPoints () {\n    this.squares.forEach(square => square.drawPoint())\n  }\n\n  drawCoordinates () {\n    this.squares.forEach((square) => square.drawCoordinates())\n  }\n\n  markPointOfTranslation () {\n    this.context.fillStyle = 'rgba(120, 230, 244, 0.2)'\n\n    this.context.beginPath()\n    this.context.arc(this.pointOfTranslation.x, this.pointOfTranslation.y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  drawEdgePoints () {\n    this.squares.forEach(square => {\n      square.drawEdgePoints()\n    })\n  }\n\n  clear () {\n    this.squares.forEach(square => square.clear())\n  }\n\n  rotateClockwise () {\n    this.squares.forEach(square => {\n      square.transformClockwise(this.pointOfTranslation.x, this.pointOfTranslation.y)\n    })\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  rotateCounterClockwise () {\n    this.squares.forEach(square => {\n      square.transformCounterClockwise(this.pointOfTranslation.x, this.pointOfTranslation.y)\n    })\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  hasPoint (otherPoint) {\n    const points = this.squares.map(square => new Point(square.point.x, square.point.y))\n    const thisPoint = points.filter(point => point.equals(otherPoint))\n    return thisPoint !== undefined && thisPoint.length && thisPoint.length !== 0 && thisPoint.equals(otherPoint)\n  }\n\n  hasCommonPointWith (otherShape) {\n    for (const square of this.squares) {\n      for (const otherSquare of otherShape.squares) {\n        if (square.equals(otherSquare)) {\n          return true\n        }\n      }\n    }\n\n    return false\n  }\n\n  moveDown () {\n    this.clear()\n    this.squares.forEach(square => square.moveDown())\n    this.largestY = this.calculateLargestY()\n    this.draw()\n  }\n\n  moveLeft () {\n    this.clear()\n    this.squares.forEach(square => square.moveLeft())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n    this.draw()\n  }\n\n  moveRight () {\n    this.clear()\n    this.squares.forEach(square => square.moveRight())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n    this.draw()\n  }\n\n  calculateLargestY () {\n    return this.squares\n      .map(square => square.point.y)\n      .sort()\n      .pop()\n  }\n\n  calculateSmallestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .shift()\n  }\n\n  calculateLargestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .pop()\n  }\n\n  getLargestY () {\n    return this.largestY\n  }\n\n  getSmallestX () {\n    return this.smallestX\n  }\n\n  getLargestX () {\n    return this.largestX\n  }\n\n  clearAndMoveSquaresBelowYLimit (yLimit) {\n    let redraw = false\n    this.squares.forEach(square => {\n      if (square.isBelowLimit(yLimit)) {\n        square.clearAndMoveDown()\n        redraw = true\n      }\n    })\n    return redraw\n  }\n}\n\nclass O extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const point2 = new Point(xCoordOfAppearance, 0)\n    const point3 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'thistle'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  rotateClockwise () { }\n\n  // eslint-disable-next-line class-methods-use-this\n  rotateCounterClockwise () { }\n}\n\nclass T extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n    const point3 = new Point(xCoordOfAppearance, 0)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightgrey'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nclass I extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0)\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0)\n    const point2 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'yellowgreen'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nclass S extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const point2 = new Point(xCoordOfAppearance, 0)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'khaki'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nclass Z extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const point2 = new Point(xCoordOfAppearance, 0)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'tan'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nclass L extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const point2 = new Point(xCoordOfAppearance, 0)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightblue'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nclass J extends Shape {\n  constructor (xCoordOfAppearance, context) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0)\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'darksalmon'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context)\n  }\n}\n\nconst shapeTypes = {\n  I,\n  O,\n  L,\n  J,\n  S,\n  Z,\n  T\n}\n\nexport default shapeTypes\n","import shapeTypes from '../shape/shape.js'\n\nexport class ShapeGenerator {\n  constructor (canvas, context) {\n    this.canvas = canvas\n    this.context = context\n  }\n\n  generateShape () {\n    const shapeTypesAsArray = Object.values(shapeTypes)\n    const chosenShapeIndex = Math.round(Math.random() * (shapeTypesAsArray.length - 1))\n    const ChosenShapeType = shapeTypesAsArray[chosenShapeIndex]\n    const xCoordinateOfAppearance = this.canvas.width / 2\n    const shape = new ChosenShapeType(xCoordinateOfAppearance, this.context)\n    return shape\n  }\n}\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport default class Grid {\n  constructor (canvas, context) {\n    this.canvas = canvas\n    this.context = context\n    this.shapes = []\n    this.movingShape = undefined\n  }\n\n  moveShapeDown () {\n    if (this.thereIsRoomToMoveDown()) {\n      this.movingShape.moveDown()\n    }\n  }\n\n  moveShapeLeft () {\n    if (this.thereIsRoomToMoveLeft()) {\n      this.movingShape.moveLeft()\n    }\n  }\n\n  moveShapeRight () {\n    if (this.thereIsRoomToMoveRight()) {\n      this.movingShape.moveRight()\n    }\n  }\n\n  moveShapeToBottom () {\n    while (this.thereIsRoomToMoveDown()) {\n      this.moveShapeDown()\n    }\n  }\n\n  noOtherShapeIsInTheWayDown () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x === point.x &&\n              otherPoint.y === point.y + SQUARE_SIDE_LENGTH)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayLeft () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x + SQUARE_SIDE_LENGTH === point.x &&\n              otherPoint.y === point.y)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayRight () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x === point.x + SQUARE_SIDE_LENGTH &&\n              otherPoint.y === point.y)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  rotateShape () {\n    this.movingShape.clear()\n    this.movingShape.rotateClockwise()\n\n    if (!(this.allPointsFitInsideGrid() && this.noOtherShapeIsInTheWay(this.movingShape))) {\n      this.movingShape.rotateCounterClockwise()\n    }\n\n    this.movingShape.draw()\n  }\n\n  allPointsFitInsideGrid () {\n    return this.movingShape.squares.map(square => square.point.x)\n      .every(x => x >= 0 && x <= this.canvas.width - SQUARE_SIDE_LENGTH) &&\n      this.movingShape.squares.map(square => square.point.y)\n        .every(y => y >= 0 && y <= this.canvas.height - SQUARE_SIDE_LENGTH)\n  }\n\n  thereIsRoomToMoveDown () {\n    const largestY = this.movingShape.getLargestY()\n    return (largestY + SQUARE_SIDE_LENGTH < this.canvas.height) && this.noOtherShapeIsInTheWayDown()\n  }\n\n  thereIsRoomToMoveLeft () {\n    return this.movingShape.getSmallestX() - SQUARE_SIDE_LENGTH >= 0 && this.noOtherShapeIsInTheWayLeft()\n  }\n\n  thereIsRoomToMoveRight () {\n    return this.movingShape.getLargestX() + SQUARE_SIDE_LENGTH < this.canvas.width && this.noOtherShapeIsInTheWayRight()\n  }\n\n  removeFullRows () {\n    const amountOfPointsInRow = this.canvas.width / SQUARE_SIDE_LENGTH\n    const rowCount = this.canvas.height / SQUARE_SIDE_LENGTH\n    let fullRowCount = 0\n\n    for (let i = 0; i < rowCount; i += 1) {\n      const occupiedSquaresAndShapes = new Map()\n      for (const shape of this.shapes) {\n        for (const square of shape.squares) {\n          if (square.point.y === i * SQUARE_SIDE_LENGTH) {\n            occupiedSquaresAndShapes.set(square, shape)\n          }\n        }\n      }\n\n      if (occupiedSquaresAndShapes.size === amountOfPointsInRow) {\n        fullRowCount += 1\n        for (const [square, shape] of occupiedSquaresAndShapes) {\n          square.clear()\n          shape.remove(square)\n        }\n        this.shiftDownward(i)\n      }\n    }\n    return fullRowCount\n  }\n\n  shiftDownward (rowIndex) {\n    //  Everything that is above this rowIndex must shift down by SIDE_LENGTH.\n    const yLimit = rowIndex * SQUARE_SIDE_LENGTH\n    for (const shape of this.shapes) {\n      const redraw = shape.clearAndMoveSquaresBelowYLimit(yLimit)\n      if (redraw) {\n        shape.draw()\n      }\n    }\n  }\n\n  noOtherShapeIsInTheWay (shape) {\n    for (const otherShape of this.shapes) {\n      if (otherShape !== shape) {\n        if (otherShape.hasCommonPointWith(shape)) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  drawLines () {\n    const rowCount = this.canvas.height / SQUARE_SIDE_LENGTH\n    for (let i = 1; i < rowCount; i += 1) {\n      this.context.strokeStyle = 'black'\n      this.context.beginPath()\n      this.context.moveTo(0, i * SQUARE_SIDE_LENGTH)\n      this.context.lineTo(this.canvas.width, i * SQUARE_SIDE_LENGTH)\n      this.context.stroke()\n    }\n  }\n\n  drawAllPoints () {\n    for (const shape of this.shapes) {\n      shape.drawPoints()\n    }\n  }\n\n  drawCoordinates () {\n    for (const shape of this.shapes) {\n      shape.drawCoordinates()\n    }\n  }\n}\n","export default class Score {\n  constructor () {\n    this.high = Score.getHighScore()\n    document.getElementById('high-score').innerText = this.high\n    this.current = 0\n  }\n\n  static getHighScore () {\n    let highScore = localStorage.getItem('tetris-high')\n    if (highScore === undefined) {\n      highScore = 0\n    }\n    return highScore\n  }\n\n  static calculateIncrease (rowsCleared) {\n    const score = (2 ** rowsCleared) + 2\n    return score\n  }\n\n  increment (value) {\n    this.current += value\n    document.getElementById('current-score').innerText = this.current\n  }\n\n  get () {\n    return this.current\n  }\n\n  set (newValue) {\n    this.current = newValue\n  }\n\n  submit () {\n    if (this.current > this.high) {\n      localStorage.setItem('tetris-high', this.current)\n      document.getElementById('high-score').innerText = this.current\n    }\n  }\n}\n","export default class Speed {\n  constructor () {\n    this.value = 0\n    this.delay = 1000\n  }\n\n  increase () {\n    this.value += 1\n    this.delay = 1000 - 100 * this.value\n  }\n\n  increaseIfNecessary (desiredSpeed) {\n    if (desiredSpeed > this.value) {\n      this.increase()\n    }\n    return this.value\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\nimport { ShapeGenerator } from '../shape-generator/shape-generator.js'\n\nimport Grid from '../grid/grid.js'\nimport Score from '../score/score.js'\nimport Speed from '../speed/speed.js'\n\nexport class Game {\n  constructor (canvas) {\n    this.canvas = canvas\n    this.context = this.canvas.getContext('2d')\n  }\n\n  init () {\n    this.setCanvasWidth()\n    this.setCanvasHeight()\n\n    window.setTimeout(() => {\n      document.getElementById('loading').hidden = true\n      document.getElementById('container').style.display = 'grid'\n    }, 200) // to allow the user some time to spot the loading text\n\n    this.grid = new Grid(this.canvas, this.context)\n    this.shapeGenerator = new ShapeGenerator(this.canvas, this.context)\n    const generatedShape = this.shapeGenerator.generateShape()\n    this.grid.shapes.push(generatedShape)\n    this.grid.movingShape = generatedShape\n    generatedShape.draw()\n    this.score = new Score()\n    this.speed = new Speed()\n    document.getElementById('current-speed').innerText = this.speed.value\n    this.SCORE_PER_SPEED_INCREASE = 50\n    this.MAX_SPEED = 9\n    this.paused = (event) => {\n      if (this.grid.movingShape) {\n        switch (event.key) {\n          case 'p': this.pause(); break\n          default: break\n        }\n      }\n    }\n    this.keyPressed = (event) => {\n      if (this.grid.movingShape) {\n        switch (event.key) {\n          case 'j': this.grid.moveShapeLeft(); break\n          case 'k': this.grid.rotateShape(); break\n          case 'l': this.grid.moveShapeRight(); break\n          case ' ':\n            // to avoid possible side effects with several intervals triggering simultaneously or closely after each other\n            window.clearInterval(this.heartbeatInterval)\n            this.heartbeatInterval = undefined\n            this.grid.moveShapeToBottom()\n\n            if (!this.grid.thereIsRoomToMoveDown()) {\n              this.grid.movingShape = undefined\n              const fullRowCount = this.grid.removeFullRows()\n              if (fullRowCount > 0) {\n                this.requestScoreIncrease(fullRowCount)\n                this.requestSpeedIncrease()\n              }\n              const generatedShape = this.shapeGenerator.generateShape()\n              if (this.grid.noOtherShapeIsInTheWay(generatedShape)) {\n                this.grid.shapes.push(generatedShape)\n                generatedShape.draw()\n                this.grid.movingShape = generatedShape\n              } else {\n                this.end()\n              }\n            }\n\n            if (this.grid.movingShape && this.heartbeatInterval === undefined) {\n              this.heartbeatInterval = window.setInterval(() => self.heartbeat(), self.speed.delay)\n            }\n            break\n          case '1': this.grid.drawAllPoints(); break\n          case '2': this.grid.drawCoordinates(); break\n          case '3': this.grid.movingShape.drawEdgePoints(); break\n          case '4': this.grid.drawLines(); break\n          default: break\n        }\n      }\n    }\n    this.keyHandler = this.keyPressed.bind(this)\n    window.addEventListener('keypress', this.keyHandler)\n    this.pauseKeyHandler = this.paused.bind(this)\n    window.addEventListener('keypress', this.pauseKeyHandler)\n\n    const self = this\n    this.heartbeatInterval = window.setInterval(() => self.heartbeat(), self.speed.delay)\n\n    this.isPaused = false\n  }\n\n  setCanvasWidth () {\n    const desiredWidth = 10 * SQUARE_SIDE_LENGTH\n\n    if (desiredWidth < window.screen.availWidth) {\n      this.canvas.width = desiredWidth\n    }\n  }\n\n  setCanvasHeight () {\n    let desiredHeight = window.screen.availHeight\n\n    if (desiredHeight % 100 !== 0) {\n      desiredHeight -= desiredHeight % 100\n    }\n\n    desiredHeight -= 100 // To leave room for browser/OS UI toolbars\n\n    if (desiredHeight > 20 * SQUARE_SIDE_LENGTH) {\n      desiredHeight = 20 * SQUARE_SIDE_LENGTH\n    }\n\n    this.canvas.height = desiredHeight\n  }\n\n  heartbeat () {\n    if (!this.grid.thereIsRoomToMoveDown()) {\n      this.grid.movingShape = undefined\n      const fullRowCount = this.grid.removeFullRows()\n      if (fullRowCount > 0) {\n        this.requestScoreIncrease(fullRowCount)\n        this.requestSpeedIncrease()\n      }\n      const generatedShape = this.shapeGenerator.generateShape()\n      if (this.grid.noOtherShapeIsInTheWay(generatedShape)) {\n        this.grid.shapes.push(generatedShape)\n        generatedShape.draw()\n        this.grid.movingShape = generatedShape\n      } else {\n        this.end()\n      }\n    }\n\n    if (this.grid.movingShape && this.grid.thereIsRoomToMoveDown()) {\n      this.grid.moveShapeDown()\n    }\n  }\n\n  end () {\n    this.score.submit()\n    Game.showGameOverText()\n    window.clearInterval(this.heartbeatInterval)\n    window.removeEventListener('keypress', this.keyHandler)\n    window.removeEventListener('keypress', this.pauseKeyHandler)\n  }\n\n  requestSpeedIncrease () {\n    if (this.speed.value < this.MAX_SPEED) {\n      const currentSpeed = this.speed.value\n      const desiredSpeed = Math.trunc(this.score.get() / this.SCORE_PER_SPEED_INCREASE)\n      const newSpeed = this.speed.increaseIfNecessary(desiredSpeed)\n\n      if (newSpeed > currentSpeed) {\n        window.clearInterval(this.heartbeatInterval)\n        const self = this\n        this.heartbeatInterval = window.setInterval(() => self.heartbeat(), self.speed.delay)\n        document.getElementById('current-speed').innerText = this.speed.value\n      }\n    }\n  }\n\n  requestScoreIncrease (rowsCleared) {\n    this.score.increment(rowsCleared)\n  }\n\n  pause () {\n    if (this.isPaused) {\n      window.addEventListener('keypress', this.keyHandler)\n      const self = this\n      this.heartbeatInterval = window.setInterval(() => self.heartbeat(), this.speed.delay)\n    } else {\n      window.clearInterval(this.heartbeatInterval)\n      window.removeEventListener('keypress', this.keyHandler)\n    }\n    this.isPaused = !this.isPaused\n  }\n\n  static showGameOverText () {\n    document.getElementById('gameOverContainer').hidden = false\n  }\n}\n","import { Game } from './game/game.js'\n\nconst canvas = document.createElement('canvas')\ncanvas.setAttribute('id', 'gameCanvas')\n\nconst gameContainer = document.getElementById('gameContainer')\ngameContainer.append(canvas)\n\nconst game = new Game(canvas)\ngame.init()\n"],"sourceRoot":""}